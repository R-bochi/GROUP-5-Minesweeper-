<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Probability Minesweeper</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(to bottom, #aee1f9, #fefefe);
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }
  h1 { margin-top: 20px; color:#2a4d69; }
  #board { display: grid; gap: 4px; margin-top: 20px; }
  .cell {
    width: 40px; height: 40px; background: #4f81c7;
    display: flex; justify-content: center; align-items: center;
    cursor: pointer; font-weight: bold; border-radius: 6px;
    user-select: none; color: white; font-size: 18px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }
  .revealed { background:#d9edf7; color:#2a4d69; }
  .mine { background:#e74c3c !important; color:white; }
  .flag { background:#f1c40f !important; color:white; }
  #questionBox {
    margin-top: 20px; padding: 10px 20px;
    background: white; border-radius: 10px;
    box-shadow:0 2px 6px rgba(0,0,0,0.2);
    width: 350px; text-align: center;
  }
  .optionBtn { display:block; margin:5px auto; padding:8px 15px; background:#2a4d69; color:white; border:none; border-radius:6px; cursor:pointer; width:80%; }
</style>
</head>
<body>
<h1>Probability Minesweeper</h1>
<div id="questionBox">
  <div id="preStartText">Please press START to start the game</div>
  <div id="question" style="display:none;"></div>
  <div id="options" style="display:none;"></div>
</div>
<button id="startBtn" style="margin-top:15px;">Start Game</button>
<div id="board"></div>

<script>
const size = 9;
const minesCount = 11;
const maxQuestions = 10;
let board = [];
let minePositions = [];
let currentQuestion = null;
let questionQueue = [];

// 50 unique and descriptive easy questions with varied correct answers
const questionPool = [
  { q:"You flip a fair coin once. What is the probability of getting heads?", options:["0.25","0.5","0.75","1"], a:"0.5" },
  { q:"You roll a standard six-sided die. What is the probability of rolling a 3?", options:["1/6","1/3","1/2","1/4"], a:"1/6" },
  { q:"A bag contains 3 red and 2 blue balls. Pick one at random. Probability it is blue?", options:["2/5","3/5","1/2","1/3"], a:"2/5" },
  { q:"Flip two coins. Probability both show tails?", options:["1/4","1/2","1/3","1/6"], a:"1/4" },
  { q:"Draw one card from a deck of 52. Probability it is an Ace?", options:["1/52","1/13","1/4","1/12"], a:"1/13" },
  { q:"Roll a die. Probability of rolling an even number?", options:["1/2","1/3","1/4","1/6"], a:"1/2" },
  { q:"A bag has 5 green and 5 yellow balls. Probability of picking a green?", options:["1/2","1/3","1/5","2/5"], a:"1/2" },
  { q:"Flip a coin once. Probability of getting tails?", options:["0.25","0.5","0.75","1"], a:"0.5" },
  { q:"Draw one card from a deck. Probability it is a heart?", options:["1/4","1/3","1/2","1/6"], a:"1/4" },
  { q:"Draw one card. Probability it is red?", options:["1/2","1/3","1/4","1/6"], a:"1/2" },
  { q:"Pick a day randomly. Probability it is Sunday?", options:["1/7","1/6","1/5","1/8"], a:"1/7" },
  { q:"Pick a King from a deck of 52 cards. Probability?", options:["1/52","1/13","1/4","1/12"], a:"1/13" },
  { q:"Roll a die. Probability of number less than 4?", options:["1/2","1/3","1/4","1/6"], a:"1/2" },
  { q:"Flip two coins. Probability one head and one tail?", options:["1/2","1/3","1/4","1/6"], a:"1/2" },
  { q:"Bag has 3 red, 2 blue, 5 green. Pick red?", options:["3/10","1/2","2/5","1/3"], a:"3/10" },
  // ... add remaining questions up to 50 with varied correct answers
];

function pickQuestions(){
  const copy = [...questionPool];
  const selected = [];
  while(selected.length<maxQuestions && copy.length>0){
    const idx = Math.floor(Math.random()*copy.length);
    selected.push(copy.splice(idx,1)[0]);
  }
  questionQueue = selected;
}

document.getElementById('startBtn').onclick = () => {
  document.getElementById('preStartText').style.display = 'none';
  document.getElementById('question').style.display = 'block';
  document.getElementById('options').style.display = 'block';
  startGame();
};

function startGame() {
  pickQuestions();
  nextQuestion();
  const boardEl = document.getElementById('board');
  boardEl.innerHTML = '';
  boardEl.style.gridTemplateColumns = `repeat(${size}, 40px)`;

  board = [];
  minePositions = generateMinesAdjusted();

  for (let r = 0; r < size; r++) {
    board[r] = [];
    for (let c = 0; c < size; c++) {
      const cell = document.createElement('div');
      cell.className = 'cell';
      cell.dataset.r = r;
      cell.dataset.c = c;
      cell.onmousedown = (e) => {
        e.preventDefault();
        if(e.button === 2){
          toggleFlag(cell);
        } else {
          reveal(cell);
        }
      };
      cell.oncontextmenu = (e)=> e.preventDefault();
      boardEl.appendChild(cell);
      board[r][c] = cell;
    }
  }
}

function nextQuestion(){
  if(questionQueue.length === 0){
    document.getElementById('question').textContent = 'All questions completed!';
    document.getElementById('options').innerHTML = '';
    return;
  }
  currentQuestion = questionQueue.shift();
  document.getElementById('question').textContent = currentQuestion.q;
  const optionsDiv = document.getElementById('options');
  optionsDiv.innerHTML = '';
  const shuffledOptions = [...currentQuestion.options].sort(() => Math.random() - 0.5);
  shuffledOptions.forEach(opt => {
    const btn = document.createElement('button');
    btn.textContent = opt;
    btn.className = 'optionBtn';
    btn.onclick = () => checkAnswer(opt);
    optionsDiv.appendChild(btn);
  });
}

function checkAnswer(ans){
  if(ans === currentQuestion.a){
    revealRandomSafe();
  } else {
    alert('Wrong! The correct answer was: '+currentQuestion.a);
  }
  nextQuestion();
}

function revealRandomSafe(){
  let safeTiles = [];
  for(let r=0;r<size;r++){
    for(let c=0;c<size;c++){
      if(!isMine(r,c) && !board[r][c].classList.contains('revealed')) safeTiles.push({r,c});
    }
  }
  if(safeTiles.length===0) return;
  const pick = safeTiles[Math.floor(Math.random()*safeTiles.length)];
  revealCell(pick.r,pick.c);
}

function revealAll(showMines){
  for(let r=0;r<size;r++){
    for(let c=0;c<size;c++){
      if(showMines && isMine(r,c)) board[r][c].textContent = 'ðŸ’£';
      revealCell(r,c);
    }
  }
}

function toggleFlag(cell){
  if(cell.classList.contains('revealed')) return;
  cell.classList.toggle('flag');
  cell.textContent = cell.classList.contains('flag') ? 'ðŸš©' : '';
}

function isMine(r, c) {
  return minePositions.includes(r * size + c);
}

function generateMinesAdjusted(){
  const positions = [];
  while (positions.length < minesCount) {
    const pos = Math.floor(Math.random() * size * size);
    const r = Math.floor(pos / size);
    const c = pos % size;
    let tooClose = false;
    for(let dr=-1; dr<=1; dr++){
      for(let dc=-1; dc<=1; dc++){
        const nr = r+dr, nc=c+dc;
        if(nr>=0 && nr<size && nc>=0 && nc<size){
          if(positions.includes(nr*size+nc)) tooClose = true;
        }
      }
    }
    if(!positions.includes(pos) && !tooClose) positions.push(pos);
  }
  return positions;
}

function reveal(cell) {
  const r = parseInt(cell.dataset.r);
  const c = parseInt(cell.dataset.c);
  if(cell.classList.contains('flag')) return;

  if (isMine(r, c)) {
    revealAll(true);
    alert('Boom! You hit a mine! Game over.');
    return;
  }

  revealCell(r, c);
}

function revealCell(r, c) {
  const cell = board[r][c];
  if (cell.classList.contains('revealed')) return;

  let count = 0;
  for (let dr=-1; dr<=1; dr++){
    for(let dc=-1; dc<=1; dc++){
      const nr = r+dr, nc=c+dc;
      if(nr>=0 && nr<size && nc>=0 && nc<size && isMine(nr,nc)) count++;
    }
  }

  cell.classList.add('revealed');
  if(isMine(r,c)) cell.textContent = 'ðŸ’£';
  else if(count>0) cell.textContent = count;
  else cell.textContent = '';
}
</script>
</body>
</html>
